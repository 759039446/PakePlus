var I=Object.defineProperty;var z=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var k=(c,s,r)=>s in c?I(c,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[s]=r,R=(c,s)=>{for(var r in s||(s={}))M.call(s,r)&&k(c,r,s[r]);if(z)for(var r of z(s))N.call(s,r)&&k(c,r,s[r]);return c};var u=(c,s,r)=>new Promise((S,b)=>{var w=m=>{try{d(r.next(m))}catch(y){b(y)}},C=m=>{try{d(r.throw(m))}catch(y){b(y)}},d=m=>m.done?S(m.value):Promise.resolve(m.value).then(w,C);d((r=r.apply(c,s)).next())});import{d as $,g as W,c as q,e as G,u as H,f as J,i as K,h as Q}from"./circle-plus-BBvPIwL1.js";import{u as P}from"./hooks-DRhJW1zI.js";import{d as X,a as Y}from"./edit-pen-BOgRmhwF.js";import{n as p,t as Z,b0 as ee,x as ae,b as f,r as x,P as T,f as U,aC as i,b1 as te}from"./index-CvraN8U6.js";function pe(){const c=p({}),s=p(!0),r=p("no"),S=p("nohide"),b=p("default"),w=p("right"),C=p([]),d=p("编辑"),m=[{label:"名称",width:120,prop:"name",valueType:"copy"},{label:"链接",prop:"url",valueType:"copy"},{label:"提取码",prop:"extractCode",valueType:"copy"},{label:"网盘类型",prop:"panType",valueType:"select",options:[{label:"夸克网盘",value:"夸克网盘"},{label:"百度网盘",value:"百度网盘"},{label:"迅雷网盘",value:"迅雷网盘"},{label:"UC网盘",value:"UC网盘"},{label:"其他",value:"其他"}]}],y=p(!1),v=p({}),E=[{label:"名称",prop:"name"},{label:"链接",prop:"url",cellRenderer:({row:e})=>f(T,null,[f(x("el-link"),{type:"primary",href:e.url,target:"_blank"},{default:()=>[e.url]})])},{label:"提取码",prop:"extractCode"},{label:"网盘类型",cellRenderer:({row:e})=>f(T,null,[f(x("el-tag"),{type:"primary"},{default:()=>[e.panType]})])},{align:"center",label:"操作",cellRenderer:({row:e})=>f(T,null,[f(x("el-button"),{link:!0,icon:P(X),type:"primary",onClick:()=>O(e)},{default:()=>[U("编辑")]}),f(x("el-button"),{link:!0,icon:P(Y),type:"danger",onClick:()=>V(e)},{default:()=>[U("删除")]})])}],a=Z({pageSize:10,currentPage:1,pageSizes:[10,15,20],total:0,align:"right",background:!0,size:"default"}),L=()=>u(this,null,function*(){a.currentPage=1,yield h(a.currentPage,a.pageSize)}),D=()=>u(this,null,function*(){c.value={},a.currentPage=1,yield h(a.currentPage,a.pageSize)});function B(){return u(this,null,function*(){d.value="添加",v.value={name:"",url:"",extractCode:"",panType:""},y.value=!0})}function h(e,l){return u(this,null,function*(){var n,t;s.value=!0;try{const g=R({page:e,pageSize:l},c.value),o=yield W(g);o.code===200?(C.value=o.data,a.total=o.total):i.error(o.message||"获取数据失败")}catch(g){i.error(((t=(n=g.response)==null?void 0:n.data)==null?void 0:t.message)||"获取数据失败")}finally{s.value=!1}})}function O(e){return u(this,null,function*(){d.value="编辑",y.value=!0,v.value={id:e.id,name:e.name,url:e.url,extractCode:e.extractCode,panType:e.panType}})}function V(e){return u(this,null,function*(){te.confirm("删除后不可恢复，是否确定删除?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>u(this,null,function*(){var l,n;try{const t=yield q(e);t.code===200?(i({type:"success",message:t.message||"删除成功"}),yield h(a.currentPage,a.pageSize)):i({type:"error",message:t.message||"删除失败"})}catch(t){i({type:"error",message:((n=(l=t.response)==null?void 0:l.data)==null?void 0:n.message)||"删除失败"})}}))})}function _(e){a.size=e}function j(e){}function F(){return u(this,null,function*(){yield h(a.currentPage,a.pageSize)})}function A(){return u(this,null,function*(){var l,n;const e=p();try{if(d.value==="添加")e.value=yield G(v.value);else if(d.value==="编辑")e.value=yield H(v.value);else{i({type:"error",message:"弹窗配置错误"});return}e.value.code===200?(i({type:"success",message:e.value.message}),y.value=!1,yield h(a.currentPage,a.pageSize)):i({type:"error",message:e.value.message})}catch(t){i({type:"error",message:((n=(l=t.response)==null?void 0:l.data)==null?void 0:n.message)||"操作失败"})}})}return ee(()=>{a.align=w.value}),ae(()=>u(this,null,function*(){yield h(a.currentPage,a.pageSize)})),{loading:s,columns:E,pageData:C,select:r,hideVal:S,tableSize:b,searchConditon:c,pagination:a,paginationAlign:w,editVisible:y,editValues:v,editColumns:m,editTitle:d,AddFill:$,onChange:_,onSizeChange:j,onCurrentChange:F,handleSearch:L,handleOpenAddDialog:B,handleRest:D,handleConfirm:A,useRenderIcon:P,handleExport:()=>u(this,null,function*(){var e,l;try{const n=yield J({name:c.value.name,panType:c.value.panType}),t=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),g=window.URL.createObjectURL(t),o=document.createElement("a");o.href=g,o.download="pan_share_export.xlsx",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(g),i.success("导出成功")}catch(n){i.error(((l=(e=n.response)==null?void 0:e.data)==null?void 0:l.message)||"导出失败")}}),handleImport:e=>u(this,null,function*(){var l,n;try{const t=yield K(e);t.code===200?(i.success(t.message||"导入成功"),h(a.currentPage,a.pageSize)):i.error(t.message||"导入失败")}catch(t){i.error(((n=(l=t.response)==null?void 0:l.data)==null?void 0:n.message)||"导入失败")}}),handleDownloadTemplate:()=>u(this,null,function*(){var e,l;try{const n=yield Q(),t=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),g=window.URL.createObjectURL(t),o=document.createElement("a");o.href=g,o.download="pan_share_template.xlsx",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(g)}catch(n){i.error(((l=(e=n.response)==null?void 0:e.data)==null?void 0:l.message)||"下载模板失败")}})}}export{pe as useColumns};
