var A=Object.defineProperty,U=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var Y=(a,l,r)=>l in a?A(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,C=(a,l)=>{for(var r in l||(l={}))j.call(l,r)&&Y(a,r,l[r]);if(M)for(var r of M(l))$.call(l,r)&&Y(a,r,l[r]);return a},R=(a,l)=>U(a,Z(l));var u=(a,l,r)=>new Promise((y,f)=>{var h=i=>{try{_(r.next(i))}catch(t){f(t)}},D=i=>{try{_(r.throw(i))}catch(t){f(t)}},_=i=>i.done?y(i.value):Promise.resolve(i.value).then(h,D);_((r=r.apply(a,l)).next())});import{aF as g,n as p,t as Q,x as W,b as c,r as T,f as z,aC as m,b1 as G}from"./index-BHiFj4_p.js";import{u as P}from"./hooks-C6A-et97.js";import{d as J,a as K}from"./edit-pen-BOgRmhwF.js";const X={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_CDN:"false",VITE_COMPRESSION:"none",VITE_HIDE_HOME:"false",VITE_PORT:"8848",VITE_PUBLIC_PATH:"/",VITE_ROUTER_HISTORY:"hash"},{VITE_BASE_API_URL:v}=X,O=a=>g.request("post",v+"/api/task/query",{data:a}),ee=a=>g.request("post",v+"/api/task/add",{data:a}),ae=a=>g.request("post",v+"/api/task/update",{data:a}),te=a=>g.request("post",v+"/api/task/delete",{data:a}),oe=()=>g.request("get",v+"/api/task/baiduCookies"),pe=()=>g.request("get",v+"/api/task/quarkCookies"),le={width:1024,height:1024,body:'<path fill="currentColor" d="M512 160c320 0 512 352 512 352S832 864 512 864S0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288c52.608 79.872 211.456 288 436.8 288c225.28 0 384.128-208.064 436.8-288c-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448a224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160s-71.744-160-160-160z"/>'};function re(){const a=p({}),l=p(!0),r=p([]),y=p("编辑"),f=p(!1),h=p(""),D=[{label:"名称",prop:"name",valueType:"input"},{label:"类型",prop:"type",valueType:"select",options:[{label:"夸克分享数据提取",value:"夸克分享数据提取"},{label:"百度分享数据提取",value:"百度分享数据提取"},{label:"夸克登录",value:"夸克登录"},{label:"百度登录",value:"百度登录"}]},{label:"状态",prop:"status",valueType:"select",options:[{label:"待执行",value:"pending"},{label:"执行中",value:"running"},{label:"已完成",value:"completed"},{label:"失败",value:"failed"}]},{label:"开始时间范围",prop:"start_time",valueType:"date-picker",fieldProps:{type:"datetimerange",valueFormat:"YYYY-MM-DDTHH:mm:ssZ",rangeSeparator:"至",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}},{label:"结束时间范围",prop:"end_time",valueType:"date-picker",fieldProps:{type:"datetimerange",valueFormat:"YYYY-MM-DDTHH:mm:ssZ",rangeSeparator:"至",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}}],_=[{label:"名称",prop:"name",valueType:"input",rules:[{required:!0,message:"请输入任务名称"}]},{label:"类型",prop:"type",valueType:"select",options:[{label:"夸克分享数据提取",value:"夸克分享数据提取"},{label:"百度分享数据提取",value:"百度分享数据提取"},{label:"夸克登录",value:"夸克登录"},{label:"百度登录",value:"百度登录"}],rules:[{required:!0,message:"请选择任务类型"}]},{label:"关联参数",prop:"params",valueType:"textarea",fieldProps:{rows:4,placeholder:"请输入关联参数"}},{label:"状态",prop:"status",valueType:"select",options:[{label:"待执行",value:"pending"},{label:"执行中",value:"running"},{label:"已完成",value:"completed"},{label:"失败",value:"failed"}],rules:[{required:!0,message:"请选择任务状态"}]},{label:"执行结果",prop:"result",valueType:"textarea"},{label:"备注信息",prop:"remark",valueType:"textarea"},{label:"开始时间",prop:"start_time",valueType:"date-picker",fieldProps:{type:"datetime",valueFormat:"YYYY-MM-DDTHH:mm:ssZ"}},{label:"结束时间",prop:"end_time",valueType:"date-picker",fieldProps:{type:"datetime",valueFormat:"YYYY-MM-DDTHH:mm:ssZ"}}],i=p(!1),t=p({}),V=p([{label:"名称",prop:"name"},{label:"类型",prop:"type",cellRenderer:({row:e})=>c(T("el-tag"),{type:"primary"},{default:()=>[e.type]})},{label:"关联参数",prop:"params"},{label:"状态",prop:"status",cellRenderer:({row:e})=>{const o={pending:{type:"info",label:"待执行"},running:{type:"warning",label:"执行中"},completed:{type:"success",label:"已完成"},failed:{type:"danger",label:"失败"}}[e.status]||{type:"info",label:e.status};return c(T("el-tag"),{type:o.type},{default:()=>[o.label]})}},{label:"执行结果",prop:"result"},{label:"备注信息",prop:"remark"},{label:"开始时间",prop:"start_time",cellRenderer:({row:e})=>e.start_time?new Date(e.start_time).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-"):"-"},{label:"结束时间",prop:"end_time",cellRenderer:({row:e})=>e.end_time?new Date(e.end_time).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-"):"-"},{align:"center",label:"操作",prop:"operation",cellRenderer:({row:e})=>{const o=(e.type==="夸克登录"||e.type==="百度登录")&&e.status==="running"&&e.params;return c("div",null,[o&&c(T("el-button"),{link:!0,icon:P(le),type:"primary",onClick:()=>B(e)},{default:()=>[z("查看")]}),c(T("el-button"),{link:!0,icon:P(J),type:"primary",onClick:()=>w(e)},{default:()=>[z("编辑")]}),c(T("el-button"),{link:!0,icon:P(K),type:"danger",onClick:()=>x(e)},{default:()=>[z("删除")]})])}}]),s=Q({pageSize:10,currentPage:1,pageSizes:[10,15,20],total:0,align:"right",background:!0,size:"default"}),E=()=>u(this,null,function*(){l.value=!0;try{const e={page:s.currentPage,pageSize:s.pageSize,name:a.value.name,type:a.value.type,status:a.value.status,result:a.value.result};a.value.start_time&&(e.start_time_ge=a.value.start_time[0],e.start_time_le=a.value.start_time[1]),a.value.end_time&&(e.end_time_ge=a.value.end_time[0],e.end_time_le=a.value.end_time[1]);const n=yield O(e);n.code===200&&(r.value=n.data,s.total=n.total)}catch(e){console.error("查询任务失败:",e)}finally{l.value=!1}}),H=()=>u(this,null,function*(){a.value={},s.currentPage=1,yield b(s.currentPage,s.pageSize)});function q(){return u(this,null,function*(){y.value="添加",t.value={name:"",type:"",params:"",status:"pending",result:"",remark:"",start_time:"",end_time:""},i.value=!0})}function b(e,n,o){return u(this,null,function*(){var d,I;l.value=!0;try{const k=C({page:e,pageSize:n},o),S=yield O(k);S.code===200?(r.value=S.data,s.total=S.total):m.error(S.message||"获取数据失败")}catch(k){console.error("请求错误:",k),m.error(((I=(d=k.response)==null?void 0:d.data)==null?void 0:I.message)||"获取数据失败")}finally{l.value=!1}})}function w(e){return u(this,null,function*(){y.value="编辑";const n=R(C({},e),{start_time:e.start_time?new Date(e.start_time).toISOString():void 0,end_time:e.end_time?new Date(e.end_time).toISOString():void 0});t.value=n,i.value=!0})}function x(e){return u(this,null,function*(){G.confirm("删除后不可恢复，是否确定删除?","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>u(this,null,function*(){var n,o;try{const d=yield te({id:e.id});d.code===200?(m({type:"success",message:d.message||"删除成功"}),yield b(s.currentPage,s.pageSize)):m({type:"error",message:d.message||"删除失败"})}catch(d){m({type:"error",message:((o=(n=d.response)==null?void 0:n.data)==null?void 0:o.message)||"删除失败"})}}))})}function B(e){h.value=e.params,f.value=!0}function F(e){s.pageSize=e,b(s.currentPage,s.pageSize)}function L(e){return u(this,null,function*(){s.currentPage=e,yield b(s.currentPage,s.pageSize)})}function N(){return u(this,null,function*(){if(t.value)try{const e={name:t.value.name,type:t.value.type,status:t.value.status,params:t.value.params,result:t.value.result,remark:t.value.remark,start_time:t.value.start_time?new Date(t.value.start_time).toISOString():void 0,end_time:t.value.end_time?new Date(t.value.end_time).toISOString():void 0};t.value.id&&(e.id=t.value.id),(yield t.value.id?ae(e):ee(e)).code===200&&(m.success(t.value.id?"更新成功":"添加成功"),i.value=!1,E())}catch(e){console.error(t.value.id?"更新任务失败:":"添加任务失败:",e)}})}return W(()=>{b(s.currentPage,s.pageSize)}),{loading:l,columns:V,pageData:r,pagination:s,editVisible:i,editValues:t,editColumns:_,searchColumns:D,editTitle:y,searchCondition:a,previewVisible:f,previewImageUrl:h,onSizeChange:F,onCurrentChange:L,handleSearch:E,handleOpenAddDialog:q,handleConfirm:N,handleRest:H,useRenderIcon:P}}const de=Object.freeze(Object.defineProperty({__proto__:null,useColumns:re},Symbol.toStringTag,{value:"Module"}));export{pe as a,de as c,oe as g,re as u};
