var P=(x,V,p)=>new Promise((d,_)=>{var r=c=>{try{a(p.next(c))}catch(k){_(k)}},f=c=>{try{a(p.throw(c))}catch(k){_(k)}},a=c=>c.done?d(c.value):Promise.resolve(c.value).then(r,f);a((p=p.apply(x,V)).next())});import{g as oe,a as le,u as ae}from"./columns-DHDKIF6T.js";import{P as te}from"./index-UeVgmzTI.js";import{d as L,n as C,I as K,r as u,o as v,g as U,h as n,e as h,b as l,f as y,c as O,u as o,aK as W,aF as ne,_ as z,Q,P as H,U as M,aC as A,aE as se,a8 as F}from"./index-DnTyjkzv.js";import{u as ie}from"./hooks-BD5VHfNf.js";import{a as re,b as ue,d as de}from"./circle-plus-aIZ2rnSb.js";import"./edit-pen-BOgRmhwF.js";import"./epTheme-B63A1nwI.js";const pe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_API_URL:"http://localhost:2556",VITE_CDN:"false",VITE_COMPRESSION:"none",VITE_HIDE_HOME:"false",VITE_PORT:"8848",VITE_PUBLIC_PATH:"/",VITE_ROUTER_HISTORY:"hash"},ce={class:"qrcode-container"},me={class:"remark-input"},fe={key:1,class:"loading"},ve={class:"action-buttons"},_e=L({__name:"index",props:{visible:{type:Boolean},type:{},onRefresh:{type:Function}},emits:["update:visible"],setup(x,{emit:V}){const{VITE_BASE_API_URL:p}=pe,d=x,_=V,r=C(""),f=C(""),a=C("");K(()=>d.visible,b=>P(this,null,function*(){b?(f.value=d.type==="quark"?"夸克网盘登录":"百度网盘登录",yield c()):(r.value="",a.value="")}));const c=()=>P(this,null,function*(){try{const b=d.type==="quark"?`${p}/api/task/quarkLogin`:`${p}/api/task/baiduLogin`,e=yield ne.request("post",b,{data:{remark:a.value}});e.code===200&&e.data&&(r.value=e.data)}catch(b){console.error("获取二维码失败:",b)}}),k=()=>P(this,null,function*(){r.value="",yield c()}),R=()=>{_("update:visible",!1),d.onRefresh&&d.onRefresh()},S=()=>{R()};return(b,e)=>{const s=u("el-button"),m=u("el-input"),g=u("el-image"),w=u("el-icon"),B=u("el-dialog");return v(),U(B,{"model-value":b.visible,"onUpdate:modelValue":R,title:f.value,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0,onClose:R},{default:n(()=>[h("div",ce,[h("div",me,[l(m,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=I=>a.value=I),placeholder:"请输入备注信息",clearable:""},{append:n(()=>[l(s,{onClick:k},{default:n(()=>e[1]||(e[1]=[y(" 重新生成 ")])),_:1})]),_:1},8,["modelValue"])]),r.value?(v(),U(g,{key:0,src:r.value,fit:"contain",style:{width:"300px",height:"300px"}},null,8,["src"])):(v(),O("div",fe,[l(w,{class:"is-loading"},{default:n(()=>[l(o(W))]),_:1}),e[2]||(e[2]=y(" 加载中... "))])),h("div",ve,[l(s,{type:"primary",onClick:S},{default:n(()=>e[3]||(e[3]=[y(" 我已登录 ")])),_:1})])])]),_:1},8,["model-value","title"])}}}),ge=z(_e,[["__scopeId","data-v-171bedd6"]]),ke={class:"image-container"},be={key:1,class:"loading"},Ce=L({__name:"index",props:{visible:{type:Boolean},imageUrl:{},onRefresh:{type:Function}},emits:["update:visible"],setup(x,{emit:V}){const p=x,d=V;function _(r){d("update:visible",r),!r&&p.onRefresh&&p.onRefresh()}return(r,f)=>{const a=u("el-image"),c=u("el-icon"),k=u("el-dialog");return v(),U(k,{"model-value":r.visible,"onUpdate:modelValue":_,title:"图片预览",width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0},{default:n(()=>[h("div",ke,[r.imageUrl?(v(),U(a,{key:0,src:r.imageUrl,fit:"contain",style:{width:"300px",height:"300px"}},null,8,["src"])):(v(),O("div",be,[l(c,{class:"is-loading"},{default:n(()=>[l(o(W))]),_:1}),f[0]||(f[0]=y(" 加载中... "))]))])]),_:1},8,["model-value"])}}}),ye=z(Ce,[["__scopeId","data-v-bfc914c5"]]),he={class:"cookie-input"},Ve={class:"cookie-input"},we={class:"dialog-footer"},Re=L({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible","success"],setup(x,{emit:V}){const p=V,d=C(),_=C(!1),r=C([]),f=C([]),a=C({type:"",baiduCookie:"",quarkCookie:""}),c={type:[{required:!0,message:"请选择任务类型",trigger:"change"}],baiduCookie:[{required:!0,message:"请输入百度cookie",trigger:"change"}],quarkCookie:[{required:!0,message:"请输入夸克cookie",trigger:"change"}]};K(()=>a.value.type,e=>{e==="百度分享数据提取"?k():e==="夸克分享数据提取"&&R()});function k(){return P(this,null,function*(){try{const e=yield oe();e.code===200&&(r.value=e.data)}catch(e){console.error("加载百度cookie失败:",e)}})}function R(){return P(this,null,function*(){try{const e=yield le();e.code===200&&(f.value=e.data)}catch(e){console.error("加载夸克cookie失败:",e)}})}function S(){var e;(e=d.value)==null||e.resetFields(),p("update:visible",!1)}function b(){return P(this,null,function*(){d.value&&(yield d.value.validate(e=>P(this,null,function*(){var s,m;if(e){_.value=!0;try{const g=a.value.type==="百度分享数据提取"?a.value.baiduCookie:a.value.quarkCookie,w=yield a.value.type==="百度分享数据提取"?re({cookie:g}):ue({cookie:g});w.code===200?(A.success("提交成功"),S(),p("success")):A.error(w.message||"提交失败")}catch(g){A.error(((m=(s=g.response)==null?void 0:s.data)==null?void 0:m.message)||"提交失败")}finally{_.value=!1}}})))})}return(e,s)=>{const m=u("el-option"),g=u("el-select"),w=u("el-form-item"),B=u("el-input"),I=u("el-form"),T=u("el-button"),$=u("el-dialog");return v(),U($,{"model-value":e.visible,"onUpdate:modelValue":s[5]||(s[5]=i=>p("update:visible",i)),title:"分享数据提取",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!0},{footer:n(()=>[h("div",we,[l(T,{onClick:S},{default:n(()=>s[6]||(s[6]=[y("取消")])),_:1}),l(T,{type:"primary",loading:_.value,onClick:b},{default:n(()=>s[7]||(s[7]=[y(" 提交 ")])),_:1},8,["loading"])])]),default:n(()=>[l(I,{ref_key:"formRef",ref:d,model:a.value,rules:c,"label-width":"100px",class:"share-form"},{default:n(()=>[l(w,{label:"任务类型",prop:"type"},{default:n(()=>[l(g,{modelValue:a.value.type,"onUpdate:modelValue":s[0]||(s[0]=i=>a.value.type=i),placeholder:"请选择任务类型",style:{width:"100%"}},{default:n(()=>[l(m,{label:"百度分享数据提取",value:"百度分享数据提取"}),l(m,{label:"夸克分享数据提取",value:"夸克分享数据提取"})]),_:1},8,["modelValue"])]),_:1}),a.value.type==="百度分享数据提取"?(v(),U(w,{key:0,label:"百度cookie",prop:"baiduCookie"},{default:n(()=>[h("div",he,[l(g,{modelValue:a.value.baiduCookie,"onUpdate:modelValue":s[1]||(s[1]=i=>a.value.baiduCookie=i),filterable:"",placeholder:"快速选择",style:{width:"100%"}},{default:n(()=>[(v(!0),O(H,null,Q(r.value,i=>(v(),U(m,{key:i.id,label:i.name,value:i.result},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(B,{modelValue:a.value.baiduCookie,"onUpdate:modelValue":s[2]||(s[2]=i=>a.value.baiduCookie=i),type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入百度cookie",clearable:""},null,8,["modelValue"])])]),_:1})):M("",!0),a.value.type==="夸克分享数据提取"?(v(),U(w,{key:1,label:"夸克cookie",prop:"quarkCookie"},{default:n(()=>[h("div",Ve,[l(g,{modelValue:a.value.quarkCookie,"onUpdate:modelValue":s[3]||(s[3]=i=>a.value.quarkCookie=i),filterable:"",placeholder:"快速选择",style:{width:"100%"}},{default:n(()=>[(v(!0),O(H,null,Q(f.value,i=>(v(),U(m,{key:i.id,label:i.name,value:i.result},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(B,{modelValue:a.value.quarkCookie,"onUpdate:modelValue":s[4]||(s[4]=i=>a.value.quarkCookie=i),type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入夸克cookie",clearable:""},null,8,["modelValue"])])]),_:1})):M("",!0)]),_:1},8,["model"])]),_:1},8,["model-value"])}}}),Ue=z(Re,[["__scopeId","data-v-6c549acc"]]),Pe={class:"main"},xe={class:"card-header"},Se={class:"right"},Ie=L({__name:"index",setup(x){const{loading:V,columns:p,pageData:d,pagination:_,editVisible:r,editValues:f,editColumns:a,searchColumns:c,editTitle:k,searchCondition:R,previewVisible:S,previewImageUrl:b,onSizeChange:e,onCurrentChange:s,handleSearch:m,handleOpenAddDialog:g,handleConfirm:w,handleRest:B}=ae(),I=C(!1),T=C("quark"),$=C(!1);function i(N){T.value=N,I.value=!0}function Y(){$.value=!0}return(N,t)=>{const D=u("el-button"),j=u("el-icon"),G=u("PlusSearch"),J=u("PlusDialogForm"),X=u("pure-table"),Z=u("el-card");return v(),O("div",Pe,[l(Z,{class:"box-card"},{header:n(()=>[h("div",xe,[t[12]||(t[12]=h("span",null,"任务管理",-1)),h("div",Se,[l(D,{type:"success",onClick:Y},{default:n(()=>t[8]||(t[8]=[y("分享数据")])),_:1}),l(D,{type:"primary",onClick:t[0]||(t[0]=E=>i("quark"))},{default:n(()=>t[9]||(t[9]=[y(" 夸克登录 ")])),_:1}),l(D,{type:"primary",onClick:t[1]||(t[1]=E=>i("baidu"))},{default:n(()=>t[10]||(t[10]=[y(" 百度登录 ")])),_:1}),l(D,{type:"primary",onClick:o(g)},{default:n(()=>[l(j,null,{default:n(()=>[l(o(se))]),_:1}),t[11]||(t[11]=y(" 新增 "))]),_:1},8,["onClick"])])])]),default:n(()=>[h("div",null,[l(G,{modelValue:o(R),"onUpdate:modelValue":t[2]||(t[2]=E=>F(R)?R.value=E:null),class:"bg-white p-[18px] rounded-[4px]",columns:o(c),"show-number":2,"label-width":"120","label-position":"right",onSearch:o(m),onReset:o(B)},null,8,["modelValue","columns","onSearch","onReset"]),l(o(te),{ref:"tableRef",title:"任务列表",columns:o(p),isExpandAll:!1,onRefresh:o(m),loading:o(V),data:o(d),pagination:o(_),paginationSmall:!0,"row-key":"id","align-whole":"center",showOverflowTooltip:"",onPageSizeChange:o(e),onPageCurrentChange:o(s)},{toolbar:n(()=>[l(D,{type:"primary",icon:o(ie)(o(de)),onClick:o(g)},{default:n(()=>t[13]||(t[13]=[y(" 新增 ")])),_:1},8,["icon","onClick"])]),default:n(({size:E,dynamicColumns:ee})=>[l(J,{visible:o(r),"onUpdate:visible":t[3]||(t[3]=q=>F(r)?r.value=q:null),modelValue:o(f),"onUpdate:modelValue":t[4]||(t[4]=q=>F(f)?f.value=q:null),form:{columns:o(a),rowProps:{gutter:20},colProps:{span:12}},dialog:{title:o(k)},onConfirm:o(w)},null,8,["visible","modelValue","form","dialog","onConfirm"]),l(ge,{visible:I.value,type:T.value,"on-refresh":o(m),"onUpdate:visible":t[5]||(t[5]=q=>I.value=q)},null,8,["visible","type","on-refresh"]),l(ye,{visible:o(S),"image-url":o(b),"on-refresh":o(m),"onUpdate:visible":t[6]||(t[6]=q=>S.value=q)},null,8,["visible","image-url","on-refresh"]),l(X,{border:"","row-key":"id",alignWhole:"center",adaptive:"",loading:o(V),showOverflowTooltip:"",data:o(d),size:E,columns:ee,pagination:o(_),onPageSizeChange:o(e),onPageCurrentChange:o(s)},null,8,["loading","data","size","columns","pagination","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh","loading","data","pagination","onPageSizeChange","onPageCurrentChange"])])]),_:1}),l(Ue,{visible:$.value,"onUpdate:visible":t[7]||(t[7]=E=>$.value=E),onSuccess:o(m)},null,8,["visible","onSuccess"])])}}}),ze=z(Ie,[["__scopeId","data-v-0a796e52"]]);export{ze as default};
